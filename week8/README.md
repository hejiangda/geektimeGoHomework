# 第8周作业

1. 使用 redis benchmark 工具, 测试 10 20 50 100 200 1k 5k 字节 value 大小，redis get set 性能。


答：连接远程redis数据库 使用命令 `redis-benchmark -h xxx -p xxx -a xxx -d value大小 -t get,set` 进行测试

a. set 

| value 大小 | 100000次执行耗时 | tps      | p99 延迟  |
|----------|-------------|----------|---------|
| 10       | 23.75       | 4211.06  | 21.135  |
| 20       | 24.52       | 4077.97  | 20.959  |
| 50       | 24.26       | 4121.67  | 21.599  |
| 100      | 26.84       | 3725.37  | 22.527  |
| 200      | 26.07       | 3835.53  | 28.047  |
| 1k       | 25.36       | 3942.60  | 24.175  |
| 5k       | 24.14       | 4142.16  | 21.599  |

b. get

| value 大小 | 100000次执行耗时 | tps      | p99 延迟  |
|----------|-------------|----------|---------|
| 10       | 24.20       | 4132.91  | 20.751  |
| 20       | 24.37       | 4103.91  | 21.551  |
| 50       | 24.47       | 4086.80  | 20.735  |
| 100      | 25.83       | 3870.72  | 25.999  |
| 200      | 25.05       | 3992.33  | 27.967  |
| 1k       | 25.35       | 3945.24  | 23.599  |
| 5k       | 23.85       | 4193.22  | 21.663  |

2. 写入一定量的 kv 数据, 根据数据大小 1w-50w 自己评估, 结合写入前后的 info memory 信息 , 分析上述不同 value 大小下，平均每个 key 的占用内存空间。

答：程序见redistest文件夹，每次测试用docker开一个新的redis容器，向其中写入指定次数指定大小的数据。info memory信息存放在test-result.md中

第一次用redis，感觉不太好分析。。。相同value下每个key的平均占用内存差不多，但要比其value大，不同value大小下，每个key所占用的内存不同，但与其value差不多

| 执行次数 | value大小(字节) | 平均占用内存空间(字节) |
|------|-------------|--------------|
| 1w   | 10          | 85.1072      |
| 5w   | 10          | 82.48576     |
| 50w  | 10          | 80.388608    |
| 1w   | 1000        | 1093.1072    |
| 5w   | 1000        | 1090.48576   |
| 50w  | 1000        | 1094.788608  |
| 1w   | 5000        | 5189.1072    |
